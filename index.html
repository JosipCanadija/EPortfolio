<!doctype html>
<html lang="hr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>E-portfolio — Luka Jovanović & Josip Čanađija</title>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* --- Osnovni stilovi --- */
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --accent:#5eead4;
      --muted:#94a3b8;
      --accent-2:#7c3aed;
      --glass: rgba(255,255,255,0.03);
      --maxwidth:1100px;
      color-scheme: dark;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:#e6eef8;background:linear-gradient(180deg,#071023 0%, #07182a 60%);-webkit-font-smoothing:antialiased}
    a{color:var(--accent);text-decoration:none}
    .container{max-width:var(--maxwidth);margin:0 auto;padding:24px;}

    /* --- Header/nav --- */
    header{background:transparent;position:sticky;top:0;z-index:50;padding:10px 0;backdrop-filter: blur(6px)}
    .navrow{display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:42px;height:42px;border-radius:8px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:#021018;font-weight:700}
    nav{display:flex;gap:18px;align-items:center}
    nav a{color:#dff7f0;padding:8px 12px;border-radius:8px;font-weight:600;font-size:14px}
    .cta{background:var(--accent);color:#022; padding:8px 12px;border-radius:8px;font-weight:700; border:none; cursor:pointer;}

    /* --- Mobile nav --- */
    .hamburger{display:none;gap:6px;flex-direction:column;cursor:pointer}
    .hamburger span{width:22px;height:2px;background:#dff7f0;border-radius:2px}

    @media (max-width: 800px) {
        nav { display: none; }
        .hamburger { display: flex; z-index: 2000; }
        .mobilemenu {
            position: absolute; top: 60px; right: 20px; width: calc(100% - 40px);
            background: #0b1220 !important; border: 1px solid rgba(255,255,255,0.12);
            padding: 12px; border-radius: 12px; display: none; flex-direction: column; z-index: 2001;
        }
        .mobilemenu a { padding: 10px 0; display: block; color: #dff7f0; font-weight: 600; }
    }

    /* --- Hero --- */
    .hero{display:flex;gap:24px;align-items:center;padding:48px 0}
    .hero-left{flex:1}
    .hero-right{flex:1;display:flex;align-items:center;justify-content:center}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);}

    h1{margin:6px 0 6px 0;font-size:32px}
    p.lead{color:var(--muted);margin:0 0 12px 0}

    /* --- Grid & Persons --- */
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:18px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    .person{display:flex;gap:12px;align-items:flex-start}
    .avatar{width:86px;height:86px;min-width:86px;border-radius:12px;background:linear-gradient(135deg,var(--accent-2),var(--accent));display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff;font-size:28px}
    .meta h3{margin:0 0 6px 0}
    .meta p{color:var(--muted);margin:0}

    /* --- Projekti --- */
    .projects{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    @media (max-width:900px){.projects{grid-template-columns:repeat(1,1fr)}}
    .project{padding:12px;border-radius:10px;background:var(--glass);cursor:pointer;border:1px solid rgba(255,255,255,0.03)}
    .filters{display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap;}

    /* --- Vještine --- */
    #skillsCard{padding:16px}
    .controls{display:flex;gap:10px;align-items:center;margin-bottom:10px;flex-wrap:wrap;}
    .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:6px 10px;border-radius:8px;color:#dff7f0;cursor:pointer}
    .btn.active{background:rgba(255,255,255,0.03);border-color:var(--accent)}
    .tooltip{position:absolute;padding:8px 10px;background:#021019;color:#dff7f0;border-radius:6px;border:1px solid rgba(255,255,255,0.04);pointer-events:none;font-size:13px;z-index:1000}

    footer{margin-top:36px;padding:18px 0;color:var(--muted);font-size:14px;text-align:center}
    .contact-wrapper { display: flex; gap: 20px; justify-content: space-between; padding: 20px; }
    @media (max-width: 700px) { .contact-wrapper { flex-direction: column; } }
  </style>
</head>
<body>

  <header class="container">
    <div class="navrow">
      <div class="brand">
        <div class="logo">TIW</div>
        <div>
          <div style="font-weight:700">E-portfolio</div>
          <div class="muted" style="font-size:13px">Luka Jovanović & Josip Čanađija</div>
        </div>
      </div>
      <nav>
        <a href="#home">Početna</a>
        <a href="#about">O nama</a>
        <a href="#projects">Projekti</a>
        <a href="#skills">Vještine</a>
        <a href="#contact" class="cta">Kontakt</a>
      </nav>
      <div class="hamburger" id="hambtn">
        <span></span><span></span><span></span>
      </div>
      <div class="mobilemenu card" id="mobilemenu">
        <a href="#home">Početna</a>
        <a href="#about">O nama</a>
        <a href="#projects">Projekti</a>
        <a href="#skills">Vještine</a>
        <a href="#contact">Kontakt</a>
      </div>
    </div>
  </header>

  <main class="container">
    <section id="home" class="hero">
      <div class="hero-left">
        <div class="card">
          <h1>Dobrodošli na e-portfolio Luke Jovanovića & Josipa Čanađije</h1>
          <p class="lead">Zajednički projektni zadatak za predmet <strong>Tehnologije Interaktivnog Weba</strong>.</p>
          <div style="display:flex;gap:8px;margin-top:12px">
            <a class="btn" href="#projects">Projekti</a>
            <a class="btn" href="#skills">Vještine</a>
          </div>
        </div>
      </div>
      
      <div class="hero-right">
        <div class="card" style="width:320px;text-align:center">
          <h3>Google Analytics Live</h3>
          <p class="muted" id="authStatus">Status: Nije autorizirano</p>
          <div style="display:flex; flex-direction:column; gap:8px; margin-top:12px; justify-content:center">
            <button class="cta" onclick="handleAuthClick()">Autoriziraj pristup</button>
            <button class="btn" id="revokeBtn" onclick="revokeToken()" style="display:none">Odjavi se</button>
          </div>
          <div id="apiResult" style="margin-top:15px; font-weight:bold; color:var(--accent); min-height: 20px;"></div>
        </div>
      </div>
    </section>

    <section id="about" style="margin-top:10px">
      <h2>O nama</h2>
      <div class="grid">
        <div class="card person">
          <div class="avatar">LJ</div>
          <div class="meta">
            <h3>Luka Jovanović</h3>
            <p class="muted">Game dizajn / 3D dizajn</p>
            <p class="muted" style="font-size:13px; margin-top:5px;">Student iz Istre, zaljubljen u 3D modeliranje (SolidWorks, Blender) i game dizajn.</p>
          </div>
        </div>
        <div class="card person">
          <div class="avatar">JČ</div>
          <div class="meta">
            <h3>Josip Čanađija</h3>
            <p class="muted">Backend / Chatbot integracija</p>
            <p class="muted" style="font-size:13px; margin-top:5px;">Student iz Kastva. Iskusan u web aplikacijama i 2D pixel umjetnosti.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="projects" style="margin-top:18px">
      <h2>Projekti</h2>
      <div class="card">
        <div class="filters">
          <button class="btn active" data-filter="all">Svi</button>
          <button class="btn" data-filter="web">Web</button>
          <button class="btn" data-filter="game">Igra</button>
          <button class="btn" data-filter="mobile">Mobile</button>
          <button class="btn" data-filter="luka">Luka</button>
          <button class="btn" data-filter="josip">Josip</button>
        </div>
        <div id="projectsList" class="projects"></div>
      </div>
    </section>

    <section id="skills" style="margin-top:18px">
      <h2>Vještine (D3.js Vizualizacija)</h2>
      <div id="skillsCard" class="card">
        <div class="controls">
          <button class="btn active" id="sortBtn">Sortiraj</button>
          <button class="btn" id="toggleBtn">Grupirano/Složeno</button>
        </div>
        <div id="chartWrap" style="position:relative">
          <svg id="skillsSvg" width="100%" height="360"></svg>
          <div id="legend" style="margin-top:8px;display:flex;gap:12px;flex-wrap:wrap"></div>
        </div>
      </div>
    </section>

    <section id="contact" style="margin-top:18px">
      <h2>Kontakt</h2>
      <div class="card contact-wrapper">
        <div class="contact-person">
          <h3>Luka Jovanović</h3>
          <p>Email: <a href="mailto:luka.jovanovic1@uniri.hr">luka.jovanovic1@uniri.hr</a></p>
          <a class="btn" href="https://github.com/" target="_blank">GitHub</a>
        </div>
        <div class="contact-person">
          <h3>Josip Čanađija</h3>
          <p>Email: <a href="mailto:josip.canadija@uniri.hr">josip.canadija@uniri.hr</a></p>
          <a class="btn" href="https://github.com/" target="_blank">GitHub</a>
        </div>
      </div>
    </section>

    <footer>
      <div class="muted">© <span id="year"></span> Luka Jovanović & Josip Čanađija</div>
    </footer>
  </main>

  <div id="tooltip" class="tooltip" style="display:none"></div>

  <script>
    /* --- KONFIGURACIJA PODATAKA --- */
    const CLIENT_ID = '957685458276-it15kjr8lp67po47lg5ef7gjgt99jc50.apps.googleusercontent.com';
    const PROPERTY_ID = '487589639';
    const SCOPES = 'https://www.googleapis.com/auth/analytics.readonly';

    const team = [
      { id: "Luka", name: "Luka Jovanović", color: "#5eead4", skills: {"HTML/CSS": 75, "JavaScript": 36, "D3.js": 28, "Unity": 91, "Blender": 80} },
      { id: "Josip", name: "Josip Čanađija", color: "#7c3aed", skills: {"HTML/CSS": 70, "JavaScript": 50, "D3.js": 35, "Unity": 90, "Blender": 20} }
    ];

    const projectsData = [
      {id:1,title:"Light Rush",tags:["game","luka"],short:"3D infinite runner."},
      {id:2,title:"MuscleBuddy",tags:["mobile","luka","josip"],short:"Fitness app."},
      {id:6,title:"Dungeon Core",tags:["game","josip"],short:"Tower defense."},
      {id:9,title:"Kastav Turizam",tags:["web","josip"],short:"Web stranica agencije."}
    ];

    /* --- OAUTH 2.0 LOGIKA --- */
    let tokenClient;
    let accessToken = null;

    function initTokenClient() {
      tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: CLIENT_ID,
        scope: SCOPES,
        callback: (tokenResponse) => {
          if (tokenResponse && tokenResponse.access_token) {
            accessToken = tokenResponse.access_token;
            document.getElementById('authStatus').innerText = "Status: Autoriziran ✅";
            document.getElementById('revokeBtn').style.display = 'inline-block';
            runAnalyticsReport();
          }
        },
      });
    }

    function handleAuthClick() {
      tokenClient.requestAccessToken({ prompt: 'consent' });
    }

    async function runAnalyticsReport() {
      const url = `https://analyticsdata.googleapis.com/v1beta/properties/${PROPERTY_ID}:runReport`;
      const body = {
        dateRanges: [{ startDate: '7daysAgo', endDate: 'today' }],
        metrics: [{ name: 'activeUsers' }]
      };
      try {
        const res = await fetch(url, {
          method: 'POST',
          headers: { 'Authorization': `Bearer ${accessToken}`, 'Content-Type': 'application/json' },
          body: JSON.stringify(body)
        });
        const data = await res.json();
        const count = data.rows ? data.rows[0].metricValues[0].value : 0;
        document.getElementById('apiResult').innerText = `Aktivni posjetitelji (7 dana): ${count}`;
      } catch (e) { console.error(e); }
    }

    function revokeToken() {
      if (accessToken) {
        google.accounts.oauth2.revoke(accessToken, () => {
          accessToken = null;
          document.getElementById('authStatus').innerText = "Status: Odjavljen";
          document.getElementById('revokeBtn').style.display = 'none';
          document.getElementById('apiResult').innerText = "";
        });
      }
    }

    /* --- UI & D3 GRAF --- */
    window.onload = () => {
      initTokenClient();
      document.getElementById('year').textContent = new Date().getFullYear();
      renderProjects();
      draw();
    };

    // Mobile menu toggle
    const hambtn = document.getElementById('hambtn');
    const mobilemenu = document.getElementById('mobilemenu');
    hambtn.onclick = () => {
      const isVisible = mobilemenu.style.display === 'flex';
      mobilemenu.style.display = isVisible ? 'none' : 'flex';
    };

    function renderProjects(filter = 'all') {
      const list = document.getElementById('projectsList');
      list.innerHTML = '';
      projectsData.filter(p => filter === 'all' || p.tags.includes(filter)).forEach(p => {
        const el = document.createElement('div');
        el.className = 'project';
        el.innerHTML = `<h4>${p.title}</h4><p class="muted">${p.short}</p>`;
        list.appendChild(el);
      });
    }

    document.querySelectorAll('[data-filter]').forEach(btn => {
      btn.onclick = () => {
        document.querySelectorAll('[data-filter]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderProjects(btn.getAttribute('data-filter'));
      };
    });

    // D3 Crtanje (pojednostavljeno za ovaj prikaz)
    const skillSet = ["HTML/CSS", "JavaScript", "D3.js", "Unity", "Blender"];
    let grouped = true;

    function draw() {
      const wrap = document.getElementById('chartWrap');
      const svg = d3.select('#skillsSvg');
      svg.selectAll('*').remove();
      
      const width = wrap.clientWidth;
      const height = 360;
      const margin = {top: 20, right: 30, bottom: 40, left: 100};
      
      const x = d3.scaleLinear().domain([0, 100]).range([0, width - margin.left - margin.right]);
      const y = d3.scaleBand().domain(skillSet).range([0, height - margin.top - margin.bottom]).padding(0.2);

      const g = svg.append('g').attr('transform', `translate(${margin.left},${margin.top})`);

      g.append('g').call(d3.axisLeft(y));
      g.append('g').attr('transform', `translate(0,${height-margin.top-margin.bottom})`).call(d3.axisBottom(x));

      skillSet.forEach(skill => {
        team.forEach((m, i) => {
          g.append('rect')
            .attr('x', 0)
            .attr('y', y(skill) + (grouped ? (i * y.bandwidth()/2) : 0))
            .attr('width', x(m.skills[skill] || 0))
            .attr('height', grouped ? y.bandwidth()/2 : y.bandwidth())
            .attr('fill', m.color)
            .attr('opacity', grouped ? 1 : 0.6);
        });
      });
    }
  </script>

  <script>
    window.__ow = window.__ow || {};
    window.__ow.organizationId = "b9cb08aa-5337-40d4-8dad-bbff77c3c2c8";
    window.__ow.template_id = "0ee65c99-d5dd-451b-8b1c-003d08f8540c";
    window.__ow.integration_name = "manual_settings";
    window.__ow.product_name = "chatbot";   
    ;(function(n,t,c){function i(n){return e._h?e._h.apply(null,n):e._q.push(n)}var e={_q:[],_h:null,_v:"2.0",on:function(){i(["on",c.call(arguments)])},init:function(){var n=t.createElement("script");n.async=!0,n.type="text/javascript",n.src="https://cdn.openwidget.com/openwidget.js",t.head.appendChild(n)}};!n.__ow.asyncInit&&e.init(),n.OpenWidget=n.OpenWidget||e}(window,document,[].slice))
  </script>
</body>
</html>
